---
permalink: maintenance-e4000/replace-hic-e4000.html 
sidebar: sidebar 
keywords:  
summary:  
---
= 更换主机接口卡(HIC)- E4000
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
按照以下过程更换E4000阵列中发生故障的主机接口卡(Host Interface Card、HIC)。

.关于此任务
更换发生故障的HIC时、必须关闭存储阵列电源(单工)或使受影响的控制器脱机(双工)、更换HIC、然后重新接通电源(单工)或使控制器联机(双工)。

.开始之前
* 如果您使用的是单工配置、请为此过程计划一个停机维护窗口。在成功完成此操作步骤之前，您无法访问存储阵列上的数据。
* 确保您已具备以下条件：
+
** 与控制器兼容的HIC。
** ESD 腕带，或者您已采取其他防静电预防措施。
** 一个无静电的平面工作区。
** 用于标识连接到控制器箱的每个缆线的标签。
** 1 号十字螺丝刀。
** 一个管理工作站，其浏览器可访问控制器的 SANtricity 系统管理器。（要打开 System Manager 界面，请将浏览器指向控制器的域名或 IP 地址。）
+

CAUTION: * 可能丢失数据访问 * —如果为另一个 E 系列控制器设计了 HIC ，请勿在 E4000 控制器箱中安装该 HIC 。此外、在双工配置中、两个控制器和两个HIC必须相同。如果存在不兼容或不匹配的 HIC ，则会在您接通电源时导致控制器锁定。







== 第1步：准备更换HIC

关闭控制器架电源(单工)或使受影响的控制器脱机(双工)、以便安全地更换HIC。

[role="tabbed-block"]
====
.关闭控制器架电源（单工）
--
.步骤
. 如果可能，请记下控制器上当前安装的 SANtricity OS 软件版本。打开SANtricity系统管理器并选择*支持›升级中心›查看软件和固件清单*。
. 如果启用了驱动器安全功能，请确保存在已保存的密钥，并且您知道安装该密钥所需的密码短语。
+

CAUTION: *可能无法访问数据*—如果存储阵列中的所有驱动器均已启用安全保护，则新控制器将无法访问存储阵列，直到您使用SANtricity Storage Manager中的“企业管理”窗口解锁受保护的驱动器为止。

+
要保存密钥（可能无法保存，具体取决于控制器的状态）：

+
.. 在SANtricity系统管理器中，选择*设置›系统*。
.. 在*安全密钥管理*下、选择*备份密钥*。
.. 在 * 定义密码短语 / 重新输入密码短语 * 字段中，输入并确认此备份副本的密码短语。
.. 单击 * 备份 * 。
.. 将您的关键信息记录在安全位置，然后单击 * 关闭 * 。


. 使用 SANtricity 系统管理器备份存储阵列的配置数据库。
+
如果删除控制器时出现问题，您可以使用保存的文件还原配置。系统将保存 RAID 配置数据库的当前状态，其中包括控制器上卷组和磁盘池的所有数据。

+
** 在 System Manager 中：
+
... *选择支持›支持中心›诊断*。
... 选择 * 收集配置数据 * 。
... 单击 * 收集 * 。
+
此文件将保存在浏览器的 "Downloads" 文件夹中，名为 * configurationData-<arrayName>-<DateTime>.7z* 。



** 或者，您也可以使用以下命令行界面命令备份配置数据库：
+
`s存取存储阵列 dbmDatabase sourceLocation=Onboard contentType=all file="filename" ；`



. 使用 SANtricity 系统管理器收集存储阵列的支持数据。
+
如果删除控制器时出现问题，您可以使用保存的文件对问题描述进行故障排除。系统会将有关存储阵列的清单，状态和性能数据保存在一个文件中。

+
.. *选择支持›支持中心›诊断*。
.. 选择 * 收集支持数据 * 。
.. 单击 * 收集 * 。
+
此文件将保存在浏览器的 "Downloads" 文件夹中，名为 * support-data.7z* 。



. 确保存储阵列与所有已连接主机之间未发生任何 I/O 操作。例如，您可以执行以下步骤：
+
** 停止涉及从存储映射到主机的 LUN 的所有进程。
** 确保没有应用程序向从存储映射到主机的任何 LUN 写入数据。
** 卸载与阵列上的卷关联的所有文件系统。
+

NOTE: 停止主机 I/O 操作的确切步骤取决于主机操作系统和配置，这些步骤不在本说明的范围之内。如果您不确定如何停止环境中的主机 I/O 操作，请考虑关闭主机。

+

CAUTION: *可能的数据丢失*—如果在执行I/O操作时继续此过程，则可能会丢失数据。



. 等待缓存中的所有数据写入驱动器。
+
需要将缓存数据写入驱动器时，控制器背面的绿色缓存活动 LED 亮起。您必须等待此 LED 关闭。

. 从 SANtricity 系统管理器的主页中，选择 * 查看正在执行的操作 * 。
. 确认所有操作均已完成，然后再继续下一步。
. 关闭控制器架上的两个电源开关。
. 等待控制器架上的所有 LED 熄灭。
. 从 Recovery Guru 中选择 * 重新检查 * ，然后确认详细信息区域中的 * 确定删除 * 字段显示 * 是 * ，表示可以安全删除此组件。除非更换控制器箱，否则无法访问存储阵列上的数据。


--
.使控制器脱机（双工）
--
.步骤
. 拆开新控制器箱的包装，将其放在无静电的平面上。
+
请保存包装材料，以便在运输故障控制器箱时使用。

. 找到控制器箱背面的 MAC 地址和 FRU 部件号标签。
. 在 SANtricity 系统管理器中，找到要更换的控制器箱的更换部件号。
+
如果控制器出现故障并需要更换，则更换部件号将显示在 Recovery Guru 的 Details 区域中。如果您需要手动查找此编号，请按照以下步骤操作：

+
.. 选择 * 硬件 * 。
.. 找到标有控制器图标的控制器架。
.. 单击控制器图标。
.. 选择控制器，然后单击 * 下一步 * 。
.. 在 * 基本 * 选项卡上，记下控制器的 * 更换部件号 * 。


. 确认故障控制器的更换部件号与更换控制器的 FRU 部件号相同。
+

CAUTION: *可能无法访问数据*—如果两个部件号不同，请勿尝试此过程。如果存在不匹配的控制器、则会导致新控制器在联机时锁定。

. 使用 SANtricity 系统管理器备份存储阵列的配置数据库。
+
如果删除控制器时出现问题，您可以使用保存的文件还原配置。系统将保存 RAID 配置数据库的当前状态，其中包括控制器上卷组和磁盘池的所有数据。

+
** 在 System Manager 中：
+
... 选择*支持›支持中心›诊断*。
... 选择 * 收集配置数据 * 。
... 单击 * 收集 * 。
+
此文件将保存在浏览器的 "Downloads" 文件夹中，名为 * configurationData-<arrayName>-<DateTime>.7z* 。



** 或者，您也可以使用以下命令行界面命令备份配置数据库：
+
[listing]
----
save storageArray dbmDatabase sourceLocation=onboard contentType=all file="filename";
----


. 如果控制器尚未脱机，请立即使用 SANtricity 系统管理器将其脱机。
+
** 在 SANtricity 系统管理器中：
+
... 选择 * 硬件 * 。
... 如果图形显示了驱动器，请选择 * 显示磁盘架背面 * 以显示控制器。
... 选择要置于脱机状态的控制器。
... 从上下文菜单中，选择 * 置于脱机状态 * ，然后确认要执行此操作。
+

NOTE: 如果您正在使用尝试脱机的控制器访问 SANtricity 系统管理器，则会显示 SANtricity 系统管理器不可用消息。选择连接到备用网络连接以使用其他控制器自动访问SANtricity系统管理器。



** 或者，您也可以使用以下命令行界面命令使控制器脱机：
+
*对于控制器A*： `set controller [a] availability=offline`

+
*对于控制器B*： `set controller [b] availability=offline`



. 等待 SANtricity System Manager 将控制器状态更新为脱机。
+

CAUTION: 更新状态之前，请勿开始任何其他操作。

. 从 Recovery Guru 中选择 * 重新检查 * ，然后确认详细信息区域中的 * 确定删除 * 字段显示 * 是 * ，表示可以安全删除此组件。


--
====


== 第 2 步：拆下控制器箱

从系统中卸下控制器箱、然后卸下控制器箱盖。

.步骤
. 如果您尚未接地，请正确接地。
. 松开将缆线绑在缆线管理设备上的黏扣带、然后从控制器箱中拔下系统缆线和SFP (如果需要)、并记录缆线的连接位置。
+
Leave the cables in the cable management device so that when you reinstall the cable management device, the cables are organized.

. 从控制器箱的左侧和右侧拆下缆线管理设备并将其放在一旁。
. 挤压凸轮把手上的闩锁、直到其释放、完全打开凸轮把手以从中板释放控制器箱、然后用两只手将控制器箱拉出机箱。
. 翻转控制器箱、将其放在平坦、稳定的表面上。
. 按下控制器箱两侧的蓝色按钮以松开护盖、然后向上旋转护盖、使其脱离控制器箱、从而打开护盖。
+
image::../media/drw_E4000_open_controller_module_cover_IEOPS-870.png[打开控制器箱盖。]





== 第 3 步：更换 HIC

更换HIC。

.步骤
. 如果您尚未接地，请正确接地。
. 卸下HIC：
+
image::../media/drw_E4000_replace_HIC_source_IEOPS-864.png[卸下HIC和板。]

+
.. 将HIC面板从控制器模块中垂直滑出、以将其卸下。
.. 拧松HIC上的翼形螺钉并将其竖直提起。
+

NOTE: 如果您用手指拧松翼形螺钉、则可能需要按下电池释放卡舌并向上旋转电池、以便更好地接触电池。



. 重新安装HIC：
+
.. 将替代HIC插头上的插槽与主板上的插槽对齐、然后将卡轻轻地垂直插入插槽中。
.. 用手拧紧HIC上的三个翼形螺钉。
+
请勿使用螺丝刀，否则可能会过度拧紧螺钉。

.. 重新安装HIC板。


. 重新安装控制器模块护盖并将其锁定到位。




== 第 4 步：重新安装控制器箱

将控制器箱重新安装到机箱中。

.步骤
. 如果您尚未接地，请正确接地。
. 如果尚未更换控制器箱上的盖子、请进行更换。
. 将控制器翻转，使可拆卸盖朝下。
. 在凸轮把手处于打开位置的情况下、将控制器完全滑入磁盘架中。
. 更换缆线。
+

NOTE: If you removed the media converters (QSFPs or SFPs), remember to reinstall them if you are using fiber optic cables.

. 使用钩环带将缆线绑定到缆线管理设备。




== 第 5 步：完成 HIC 更换

启动控制器(单工)或使控制器联机(双工)、收集支持数据并恢复操作。

[role="tabbed-block"]
====
.启动控制器（单工）
--
.步骤
. 打开控制器架背面的两个电源开关。
+
** 请勿在启动过程中关闭电源开关，此过程通常需要 90 秒或更短的时间才能完成。
** 每个磁盘架中的风扇在首次启动时声音非常大。启动期间发出较大的噪音是正常的。


. 控制器恢复联机后、检查控制器架的警示LED。
+
如果状态不是最佳状态或任何警示 LED 均亮起，请确认所有缆线均已正确就位，并检查电池和控制器箱是否已正确安装。如有必要，请拆下并重新安装控制器箱和电池。

+

NOTE: 如果无法解决此问题，请联系技术支持。如果需要，请使用 SANtricity 系统管理器收集存储阵列的支持数据。

. 使用 SANtricity 系统管理器收集存储阵列的支持数据。
+
.. 选择*支持›支持中心›诊断*。
.. 选择收集支持数据。
.. 单击收集。
+
此文件将保存在浏览器的 "Downloads" 文件夹中，名为 * support-data.7z* 。





--
.使控制器联机（双工）
--
.步骤
. 使用 SANtricity 系统管理器使控制器联机。
+
** 在 SANtricity 系统管理器中：
+
... 选择 * 硬件 * 。
... 如果图形显示了驱动器，请选择 * 显示磁盘架背面 * 。
... 选择要置于联机状态的控制器。
... 从上下文菜单中选择 * 置于联机状态 * ，然后确认要执行此操作。
+
系统将控制器置于联机状态。



** 或者，您也可以使用以下命令行界面命令将控制器重新联机：
+
*对于控制器A*: `set controller [a] availability=online`；

+
*对于控制器B*： `set controller [b] availability=online`;



. 控制器恢复联机后、检查控制器架的警示LED。
+
如果状态不是最佳状态或任何警示 LED 均亮起，请确认所有缆线均已正确就位，并检查电池和控制器箱是否已正确安装。如有必要，请拆下并重新安装控制器箱和电池。

+

NOTE: 如果无法解决此问题，请联系技术支持。如果需要，请使用 SANtricity 系统管理器收集存储阵列的支持数据。

. 验证所有卷是否均已返回到首选所有者。
+
.. 选择*存储›卷*。在 * 所有卷 * 页面中，验证卷是否已分发到其首选所有者。选择*更多›更改所有权*以查看卷所有者。
.. 如果所有卷均归首选所有者所有、请继续执行步骤5。
.. 如果未返回任何卷，则必须手动返回这些卷。转到*更多›重新分发卷*。
.. 如果在自动分发或手动分发之后只有部分卷返回给其首选所有者、则必须检查Recovery Guru以了解主机连接问题。
.. 如果不存在Recovery Guru、或者在执行Recovery Guru步骤后、卷仍未返回到其首选所有者、请联系支持部门。


. 使用 SANtricity 系统管理器收集存储阵列的支持数据。
+
.. 选择*支持›支持中心›诊断*。
.. 选择收集支持数据。
.. 单击收集。
+
此文件将保存在浏览器的 "Downloads" 文件夹中，名为 * support-data.7z* 。





--
====
.下一步是什么？
主机接口卡更换已完成。您可以恢复正常操作。
